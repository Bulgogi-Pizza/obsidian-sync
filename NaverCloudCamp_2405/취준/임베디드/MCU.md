# Micro Controller Unit
- CPU의 기능을 하는 핵심 장치와 그 주변 장치들을 포함하고 있는 통합형 칩셋
- 소형 칩(Micro Unit) 하나만으로 LED나 모터와 같은다른 부품들을 제어(Controll)할 수 있음

# 알맞는 MCU 선택법
- 데이터시트로부터 기준을 확인하기
	- CPU(MPU) 성능
		- 연산 속도(Hz)
		- 연산 숫자 수(비트)
	- 메모리 크기와 종류
		- ROM 크기와 종류(마스크, EPROM, EEPROM 등)
		- RAM 크기
	- 전기적 특성
		- 동작 전압
		- 전류 및 전력 소비
	- 내장 주변장치 기능
		- 타이머(범용, 클록, PWM 출력)
		- 통신 프로토콜
			- USART
			- SPI
			- I2C
			- USB
			- 등등
		- 특수 기능
			- LAN, 암호화 기법, LCD 제어/구동 및 카메라 인터페이스
		- 아날로그 회로
			- AD 컨버터
			- DA 컨버터
			- 등등
	- 패키지
		- 패키지 유형(QFP, BGA, QFN)
		- 핀 수(20, 32, 64, 100)
	- 가격
- 가장 중요한 것은 CPU(MPU) 성능

## CPU 성능
### 비트와 클럭
- 16비트 CPU를 탑재해도 8비트 내부 버스를 사용할 경우 16비트에서 가능한 내부 처리 성능의 일부만 수행할 수 있음
- 동일한 아키텍쳐 기준 더 높은 주파수가 더 높은 성능을 가짐
- 일부 MCU는 내부 버스 속도와 다른 코어 속도를 갖고 있음, 고속 코어와 저속 버스를 갖는 경우, 버스 액세스 동작이 연산 과정에 포함된다면 CPU 성능이 저하될 수 있음

### 아키텍처와 성능 지표
- 대표적인 MCU 아키텍처 설계 방식 두가지
	- RISC
		- Reduced Instruction Set Computer
		- 간단하고 적은 종류의 명령어와 주소 지정 모드를 사용
		- 고정 길이 명령어 형식
		- CISC에 비해 명령어 수가 적음
		- 하드와이어드(논리 회로를 이용한 하드웨어)적 제어 방식
		- 효율적인 파이프라이닝 구조 사용
		- 명령어가 하드웨어적이므로 호환성이 낮음
		- 명령어의 길이가 미리 정해져 있어 해석 속도가 빠름
		- 작고 빠른 명령어들을 사용하기 위해 많은 수의 범용 레지스터가 사용되며, 처리속도가 빠르고 하드웨어 구조가 간단함
		- 효율성이 떨어지지만 전력 소모가 작으며, 처리 비트 단위가 변하거나 프로세서 구조가 조금만 바뀌어도 하위 프로세서와의 호환성이 떨어짐
		- 고성능의 워크스테이션이나 그래픽용 컴퓨터에서 주로 사용
	- CISC
		- Complex Instruction Set Computer
		- 복잡하고 많은 종류의 명령어와 주소 지정 모드를 사용
		- 가변 길이 명령어 형식
		- 100개 ~ 250개 정도의 많은 명령어를 가지고 있어 설계가 어려움
		- 마이크로 프로그래밍(S/W) 제어 방식
		- 명령어가 S/W적이므로 호환성이 좋음
		- 명령어 해석 후 명령어 실행
		- 컴파일 과정이 쉽고 호환성이 좋다는 장점이 있지만 속도가 느림
- 성능 지표를 위한 개념
	- CPI
		- Cycle Per Instruction
		- 프로그램에 대한 명령어당 평균 사이클 수
		- 프로그램 수행 시간 T = Ic(Instruction Count) * CPI * t(클록 주기)
	- IPS
		- Instruction Per Seconds
		- 단위 시간당 처리할 수 있는 명령어
		- IPS = Ic(Instruction Count) / T(단위 시간)
- 성능 지표
	- MIPS
		- Million Instructions Per Second
		- CPU가 1초 동안 처리할 수 있는 명령의 수
		- 1MIPS -> 1초에 100만개의 명령어 처리 가능
		- 예제
			- A CPU = 2GHz, CPI = 2 clock
			- B CPU = 3GHz, CPI = 4 clock
			- -> A CPU MIPS = 2GHz / 2 * 10<sup>6</sup> = 1000MIPS
			- -> B CPU MIPS = 3GHz / 4 * 10<sup>6</sup> = 750MIPS
			- 클럭만 보았을 땐 B가 더 빨라보이지만 MIPS는 A가 더 높음
		- MIPS는 명령어의 종류에 관계없이 1초당 실행되는 명령어 수만 계산하기 때문에 복잡성과 같은 명령어별 특성을 고려하지 않음
		- 이를 개선하기 위해 나온 방안이 DMIPS(Dhrystone MIPS)
	- DMIPS
		- Dhrystone Million Instructions Per Second
		- Dhrystone(D)은 측정 대상이 되는 시스템으로 기준이 되는 특정 작업을 수행시켜 걸리는 시간을 측정한 후 이를 정수화하여 CPU의 성능을 비교할 수 있도록 고안된 벤치마크 프로그램
		- DMIPS = MIPS / 1757
		- Dhrystone 테스트 결과가 9193924라면 1757을 나눈 5233이 DMIPS가 됨
	- CoreMark

## 메모리 크기 및 종류
- 최근 MCU의 내부 ROM에 가장 많이 사용되는 종류의 메모리
	- 플래시
- 사용 가능한 다른 종류의 메모리
	- Mast
	- EEPROM
		- Electrically Erasable Programmable Read-Only Memory
	- EPROM
		- Erasable Programmable Read-Only Memory
- 프로그램의 실제 크기와 처리하 데이터 양은 프로그램을 생성하기 전까지 명확히 아 수 없으므로, 메모리 크기가 가장 큰 MCU를 택해 테스트한 후 결과를 평가

## 전기적 특성(동작 전압과 전류 소비)
- 가장 친숙한 전원 유형 -> 배터리
- 2개의 배터리 -> 3V
- 이럴 땐 3V의 전원 전압을 갖는 MCU를 선택해야 함
- 낮은 전류의 MCU를 사용하면 배터리의 수명이 길어짐
- 상용 전원으로부터 DC 전원을 생성하거나 전압 레귤레이터 IC 등을 사용하면 원하는 전압과 전류 사용 가능
