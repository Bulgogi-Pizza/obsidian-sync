# 개념
- 하드웨어와 운영체제를 연결해주는 장치
- 디바이스 드라이버, 하드웨어 드라이버

# 윈도우의 경우
- 굳이 설치할 필요 없이 필요한 드라이버를 이미 내장하고 있음
	- 플러그 앤 플레이

# STM32F 시리즈의 HAL Drivers

## HAL
- Hardware abstraction layer
- 하드웨어 추상 층?
- 디바이스 레벨에 존재하며 API를 사용해 디바이스에 종속되지 않는 프로그래밍을 할 수 있음
- OS 커널을 수정하여 다양한 하드웨어 아키텍쳐에 대응하는 프로그램을 실행하는 것을 피하기 위해 사용
- OS 커널이나 디바이스 드라이버의 형태로 HAL을 포함하고 있는 PC는 직관적인 인터페이스를 제공하고 하드웨어간의 상호작용을 제공함

# 디바이스 드라이버의 유형
1. MCU 주변장치(페리페럴, Peripheal) 드라이버
2. 외부 장치 드라이버
	- I2C, SPI, UART와 같은 통신 인터페이스를 통해 연결된 외부 장치 드라이버

# 설계 기술
## 1. 폴링(Polling)
- 주변장치 또는 외부장치를 **주기적으로 검사**하여 정보를 보내거나 받을 준비가 되었는지 확인하는 것
- 플래그 상태를 확인하는 것 이상의 기능은 수행하지 않기 떄문에 구현이 매우 쉬움
- 예제
	- ADC(Analog-Digital Converter) 드라이버는 변환 시퀀스를 시작한 다음 단순히 프로세서 실행을 차단하고 ADC 완료 플래그를 지속적으로 확인
	```C
	Adc_Start();
	while(ADC_COMPLETE_FLAG == FALSE);
	AdcResults = Adc_ReadAll();
	return AdcResults;
	```

- 특성
	1. 대부분의 폴링 드라이버는 기능 실행시 프로세서 작업 차단, 일단 드라이버가 호출되면 필요한 결과를 얻을 때까지 프로세스 종료 X 물론 드라이버가 결과를 한번만 확인한 후 종료되도록 구현할 수도 있음. 하지만 이 때, 응용 프로그램은 드라이버 자체를 주기적으로 폴링하도록 구현되어야 함
	2. 폴링 드라이버는 일반적으로 구현하기가 쉬움, 개발자가 해야하는 일은 레지스터의 몇개 비트를 파악하고, 이를 모니터링하여, 디바이스와 상호작용할 시기를 결정하는 것. 폴링 드라이버는 비효율적인 방식으로 구분됨. 인터럽트, DMA와 같은 드라이버 설계 기술은 비효율적인 작업을 수행 시 MCU에 즉각 알릴 수 있지만, 폴링 드라이버는 미리 정의된 작업을 끝내기 전까지는 중단될 수 없음

## 2. 인터럽트 구동(Interrupt-Driven)
- 인터럽트 방식의 드라이버를 사용하는 것은 시스템 효율성을 크게 향상시킴
- 인터럽트는 프로세서에 드라이버가 준비되었음을 즉각적으로 알림
- 알림을 받으면, 프로세서는 인터럽트를 처리하기 위해 해당 위치로 점프

- 인터럽트 수행 상세 절차
	1. 입출력 하드웨어 제어기가 인터럽트 요청 라인에 신호를 보냄
	2. 프로세서는 레지스터와 상태 정보를 저장한 다음 인터럽트 핸들러 루틴으로 이동
	3. 인터럽트 핸들러는 인터럽트의 발생 원인을 조사하고 필요한 일련의 작업을 수행
	4. 프로세서는 저장했던 인터럽트 발생이전의 상태로 되돌아가는 명령 수행

- 대부분의 MCU는 두 종류의 인터럽트 요청 라인을 가짐
	1. 마스크 불가 인터럽트
		- 회복 불가능한 메모리 에러와 같은 이벤트를 위해 사용
	2. 마스크 가능 인터럽트
		- 필요 시 인터럽트 기능을 잠시 중단시킬 수 있음
		- 인터럽트가 중간에 수행되어서는 안되는 주요 명령 시퀀스를 위한 기능

https://m.blog.naver.com/techref/222316581200
이어서작성
